machine:
  php:
    version: 5.5.11
  node:
    version: 0.10.38
dependencies:
  pre:
    - sed -i 's/^;//' ~/.phpenv/versions/$(phpenv global)/etc/conf.d/xdebug.ini
test:
  override:
    - vendor/bin/phpunit --debug --coverage-clover build/logs/clover.xml
  post:
    - vendor/bin/test-reporter
deployment:
  staging:
    branch: master
    commands:
      - bower install
      - ./node_modules/.bin/gulp
      - rm -rf /node_modules
      - rm -rf resources/assets/vendor
      - rm -rf package.json
      - rm -rf bower.json
      - composer install --no-dev
      - git push git@heroku.com:visa-status.git $CIRCLE_SHA1:master